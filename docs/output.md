# IntGenomicsLab/lrsomatic: Output

## Introduction

This document describes the output produced by the pipeline. Most of the plots are taken from the MultiQC report, which summarises results at the end of the pipeline.

The directories listed below will be created in the results directory after the pipeline has finished. All paths are relative to the top-level results directory.

<!-- TODO nf-core: Write this documentation describing your workflow's output -->

## Pipeline overview

The pipeline is built using [Nextflow](https://www.nextflow.io/) and processes data using the following steps:

- [samtools/cat](#samtools_cat) - Concatenate replicates from the same sample
- [minimap2/index](#minimap2) - Creating minimap2 index
- [minimap2/align](#minimap2) - Aligning long-read samples to the reference genome
- [Cramino](#cramino) - Quality check the aligned or unaligned lomg read bam files
- [Modkit](#modkit) - Tool to process methylation data
- [Mosdepth](#mosdepth) - Tool to check the sequencing depth
- [ClairS-TO](#clairsto) - Small Variant Calling for Tumour only samples
- [Severus](#severus) - Tool to call somatic and germline structural variants
- [MultiQC](#multiqc) - Aggregate report describing results and QC from the whole pipeline
- [Pipeline information](#pipeline-information) - Report metrics generated during the workflow execution
- [Longphase](#longphase) - Phase the variants into haplotype blocks

### samtools

### Minimap2

[ClairS-TO](https://github.com/HKU-BAL/ClairS-TO) ool in the Clair series to support long-read somatic small variant calling with only tumor samples available. For more information, see <https://github.com/HKU-BAL/ClairS-TO>.

### Cramino

<details markdown="1">
<summary>Output files</summary>

- `cramino/`
  - `*_cramino.txt`: text file containing the quality check results from Cramino

</details>

[Cramino](https://github.com/wdecoster/cramino) is a tool for fast quality check of aligned or unaligned long read sequencing bam files. For more information, check <https://github.com/wdecoster/cramino>.

### Modkit

<details markdown="1">
<summary>Output files</summary>

- `modkit/`
  - `*.bed`: bed file with genomic positions with modified bases
  - `*.bedgraph`: bedgraph file with genomic positions with modified bases
  - `*log`: log file

</details>

[Modkit](https://github.com/nanoporetech/modkit) is a tool to work with methylated bases from bam files. It allows you to update the bam file modification information, filter the information, or to extract it to other file formarts such as bed file. For more information, see <https://github.com/nanoporetech/modkit>.

### Mosdepth

<details markdown="1">
<summary>Output files</summary>

- `mosdepth`
  - `*.summary.txt'`: summary text file
  - `*.global.dist.txt`: global information on sequencing depth file
  - optionally outputs other files by regions.

</details>

[Mosdepth](https://github.com/brentp/mosdepth) is a tool to work with WGS/exome/targeted sequencing data to obtain sequecing depth information, For more information, see <https://github.com/brentp/mosdepth>.

### ClairS-TO

<details markdown="1">
<summary>Output files</summary>

- `clairsto/`
  - `germline.vcf.gz`: a VCF file containing germline SNP and indel calls
  - `somatic.vcf.gz`: a VCF file containing somatic SNP and indel calls
  - `logs`: directory containing log files for the ClairS-TO run
  - `run_clairs_to.log`: a text file containing a summary of the ClairS-TO run
  - `run_clairs_to.log.bak`: a text file containing the run command

</details>

### Severus

<details markdown="1">
<summary>Output files</summary>

- `severus`
- `severus.log`: severus log file
- `read_qual.txt`: the read quality
- `breakpoints_double.csv`: the breakpoint file

</details>

[Severus](https://github.com/KolmogorovLab/Severus) is a tool to call not only somatic, but also germline structural variant calls. For mor information on the tool and its usage, check out <https://github.com/KolmogorovLab/Severus>.

### Longphase

<details markdown="1">
<summary>Output files</summary>

TODO - add description ot output file

- `longphase/`

</details>

[Longphase](https://github.com/twolinin/longphase) isa tool to phase your input variant calls and haplotag your bam. To see more, see <https://github.com/twolinin/longphase>.

### MultiQC

<details markdown="1">
<summary>Output files</summary>

- `multiqc/`
  - `multiqc_report.html`: a standalone HTML file that can be viewed in your web browser.
  - `multiqc_data/`: directory containing parsed statistics from the different tools used in the pipeline.
  - `multiqc_plots/`: directory containing static images from the report in various formats.

</details>

[MultiQC](http://multiqc.info) is a visualization tool that generates a single HTML report summarising all samples in your project. Most of the pipeline QC results are visualised in the report and further statistics are available in the report data directory.

Results generated by MultiQC collate pipeline QC from supported tools e.g. FastQC. The pipeline has special steps which also allow the software versions to be reported in the MultiQC output for future traceability. For more information about how to use MultiQC reports, see <http://multiqc.info>.

<details markdown="1">
<summary>Output files</summary>

- `multiqc/`
  - `multiqc_report.html`: a standalone HTML file that can be viewed in your web browser.
  - `multiqc_data/`: directory containing parsed statistics from the different tools used in the pipeline.
  - `multiqc_plots/`: directory containing static images from the report in various formats.

</details>

[MultiQC](http://multiqc.info) is a visualization tool that generates a single HTML report summarising all samples in your project. Most of the pipeline QC results are visualised in the report and further statistics are available in the report data directory.

Results generated by MultiQC collate pipeline QC from supported tools e.g. FastQC. The pipeline has special steps which also allow the software versions to be reported in the MultiQC output for future traceability. For more information about how to use MultiQC reports, see <http://multiqc.info>.

### Pipeline information

<details markdown="1">
<summary>Output files</summary>

- `pipeline_info/`
  - Reports generated by Nextflow: `execution_report.html`, `execution_timeline.html`, `execution_trace.txt` and `pipeline_dag.dot`/`pipeline_dag.svg`.
  - Reports generated by the pipeline: `pipeline_report.html`, `pipeline_report.txt` and `software_versions.yml`. The `pipeline_report*` files will only be present if the `--email` / `--email_on_fail` parameter's are used when running the pipeline.
  - Reformatted samplesheet files used as input to the pipeline: `samplesheet.valid.csv`.
  - Parameters used by the pipeline run: `params.json`.

</details>

[Nextflow](https://www.nextflow.io/docs/latest/tracing.html) provides excellent functionality for generating various reports relevant to the running and execution of the pipeline. This will allow you to troubleshoot errors with the running of the pipeline, and also provide you with other information such as launch commands, run times and resource usage.
